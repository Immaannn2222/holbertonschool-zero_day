A preface and and an interaction to optimize this code  